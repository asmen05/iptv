<!DOCTYPE html>
<html lang="ar">
<head>
<meta charset="UTF-8">
<title>MBC Channels</title>
<style>
    body { font-family: Arial, sans-serif; background: #000; color: #fff; margin: 0; padding: 10px; }
    h2 { text-align: center; margin-bottom: 20px; }
    .channel { display: flex; align-items: center; margin: 10px 0; padding: 5px; cursor: pointer; border-radius: 5px; transition: background 0.2s; }
    .channel img { width: 80px; height: 45px; margin-right: 10px; border-radius: 4px; }
    .channel:hover { background: #222; }
    video { width: 100%; max-height: 300px; margin-top: 20px; background: #000; border-radius: 5px; }
</style>
</head>
<body>

<h2>قنوات MBC</h2>
<div id="channelsList"></div>
<video id="player" controls autoplay></video>

<script>
async function loadChannels() {
    const apiUrl = "https://cast-x.com/aghmdev/castxv2/api/get/?from=channels&cat=categories&parent=mbc_all";
    try {
        const res = await fetch(apiUrl);
        const data = await res.json();
        const channels = data.data;
        const listDiv = document.getElementById("channelsList");

        channels.forEach(channel => {
            const servers = JSON.parse(channel.servers);
            const url = servers[0].url; // الرابط الأول للبث
            const div = document.createElement("div");
            div.className = "channel";
            div.innerHTML = `<img src="${channel.logo}" alt="${channel.title}"><span>${channel.title}</span>`;

            div.onclick = () => {
                const player = document.getElementById("player");
                player.src = url;
                player.play();
            }

            listDiv.appendChild(div);
        });
    } catch(err) {
        console.error("Error loading channels:", err);
        document.getElementById("channelsList").innerHTML = "<p>فشل تحميل القنوات.</p>";
    }
}

// تحميل القنوات عند فتح الصفحة
loadChannels();
</script>

</body>
</html>
